version: '3'

services: 
  app:
    build: 
      context: .
    volumes:
      - static_data:/vol/web
    environment:
      - SECRET_KEY=sampleSecretKey
      - ALLOWED_HOSTS=127.0.0.1,localhost,payment.bracnet.net,202.168.232.8
      - DB_HOST=db
      - DB_NAME=bracnet_payment_api
      - DB_USER=faz13
      - DB_PASS=faz13
    depends_on: 
      - db
    db:
      image: mariadb:10.5.8
      environment:
        MYSQL_ROOT_PASSWORD: root@123
        MYSQL_DATABASE: bracnet_payment_api
        MYSQL_USER: faz13
        MYSQL_PASSWORD: faz13
      volumes: 
        # - ./db/data:/var/lib/mysql
        - ./db/test_permission.sql:/docker-entrypoint-initdb.d/test_permission.sql
    proxy:
      build:
        context: ./proxy
      volumes: 
        - static_data:/vol/static
      ports: 
        - "8080:8080"
      depends_on: 
        - app
volumes: 
 static_data: